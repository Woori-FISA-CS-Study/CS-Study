## 네트워크의 기초
## 네트워크란
노드와 링크가 서로 연결되어 있거나 리소스를 공유하는 집합
- 노드 : 서버, 라우터, 스위치 등 네트워크 장치
- 링크 : 유무선
### 처리량과 지연시간
- 처리량 : 링크 내에서 성공적으로 전달된 데이터의 양
- 단위 : bps
- 영향 : 사용자 접속 트래픽, 네트워크 장치간 대역폭, 네트워크 중간 발생 에러, 장치 하드웨어 스펙
- 대역폭 : 주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트수
- 지연시간 : 요청이 처리되는 시간, 어떤 메시지가 두 장치 사이를 왕복하는데 걸리는 시간
- 영향 : 매체 타입, 패킷크기, 라우터의 패킷 처리 시간

## 네트워크 토폴로지와 병목 현상
## 네트워크 토폴로지
네트워크 설계 시 노드와 링크가 어떻게 배치되어 있는지에 대한 방식이자 연결 형태
- 트리토폴로지 : 계층형
- 버스토폴로지 : 중앙통신회선 하나에 여러개의 노트가 연결되어 공유하는 네트워크 구성 / LAN(근거리 통신망) / 설치비용 적음, 신뢰성 우수 , 회선 추가 삭제가 쉬움 / 스푸핑이 가능한 문제점
- 스푸핑 : LAN 상에서 스위칭기능을 마비시켜 특정 노트에 해당 패킷이 오도록 처리하는 것.
- 스타 토폴로지 : 중앙 노드 집중형 / 장애발견 쉬움 / 중앙노드 장애 시 전체 이용불가, 비쌈
- 링형 토폴로지 : 양 옆 두 노드 연결. 고리형 / 네트워크 손실이 거의 없음 / 구성변경이 어려움, 회선 장애 시 전체 네트워크에 영향
- 메시 토폴로지 : 망형 토폴로지, 그물망형태 / 트래픽분산처리 가능 / 노트 추가 어려움, 구축 비용 운용비용 비쌈
## 병목현상
전체 시스템의 성능이나 용량이 하나의 구성 요소로 인해 제한 받는 현상 -> 네트워크 토폴로지에 대한 이해가 있어야 해결가능.

### 네트워크 분류(규모)
<img width="350" height="400" alt="image" src="https://github.com/Woori-FISA-CS-Study/CS-Study/assets/35751392/15a098fb-159a-4880-89f2-497af9d4b701">

- **WAN** : 광역 네트워크
- MAN : 대도시 지역 네트워크
- **LAN** : 근거리통신망

## 네트워크 성능 분석 명령어
**네트워크 병목 현상의 주된 원인**
- 네트워크 대역폭
- 네트워크 토폴로지
- 서버 CPU, 메모리 사용량
- 비효율적인 네트워크 구성

**네트워크 성능분석 시 사용되는 명령어**
- ping [IP주소 또는 도메인 주소] : 네트워크 상태 확인을 위한 대상에 일정크기의 패킷을 전송하는 명령어
  EX) ping www.google.com -n 12 : 12번 패킷을 보내고 12번의 패킷을 받음.
  
  <img width="422" alt="image" src="https://github.com/Woori-FISA-CS-Study/CS-Study/assets/35751392/29248eda-870c-4634-981a-062008ea1baf">

- **telnet** : telnet을 통해 특정 IP와 특정 포트로 원격 접속
  EX) telnet [목적지 서버IP] [서비스PORT]
- **netstat** : 접속되어 있는 서비스의 네트워크 상태를 표시. 네트워크 접속, 라우팅 테이블, 네트워크 프로토콜 리스트
- nslookup : DNS에 관련된 내용 확인 명령어. 특정 도메인에 매핑된 IP 확인용도.
- tracert(window) / traceroute(linux) : 네트워크 경로 확인, 구간 응답 시간을 확인 할 수 있음.

### 네트워크 프로토콜 표준화
네트워크 프로토콜이란 장치들끼리 데이터를 주고받기 위해 설정된 공통된 인터페이스
IEEE 또는 IETF 표준화 단체에서 정함

## TCP/IP 4계층 모델

<img width="280" height="300" alt="image" src="https://github.com/Woori-FISA-CS-Study/CS-Study/assets/35751392/43e025f9-39da-4c09-b519-29d1f2df847f"><img width="414" alt="image" src="https://github.com/Woori-FISA-CS-Study/CS-Study/assets/35751392/0c086d88-12b0-41b4-91b4-f128b5242feb">



## 애플리케이션 계층
FTP , SSH , HTTP, SMTP, DNS 등 응용 프로그램에서 사용되는 프로토콜 계층

## 전송계층
- TCP : 올바른 패킷 순서 보장 , 신뢰성 높음, 가상회선 패킷 교환방식, 정확한 데이터 송수신 가능. 속도가 상대적으로 느림.
- UDP : 데이터그램 패킷 교환방식, 신뢰성 보다는 빠른 속도를 중요시.
- 가상회선 패킷 교환방식 : 순서보장
- 데이터그램 패킷 교환방식 : 순서보장하지 않음, 패킷이 독립적으로 이동, 최적의 경로로 이동

**TCP 연결 성립 과정** 

TCP는 신뢰성을 확보할 때 3-웨이 핸드셰이크 작업을 진행.
- SYN 단계 (연결 요청 플래그) : 클라이언트 -> 서버, ICN을 담아 SYN으로 보냄.
- SYN + ACK 단계 (응답 플래그) : 서버가 수신, 승인번호로 클라이언트의 ICN + 1을 보냄.
- ACK 단계

- ICN : 초기 네트워크 연결시 할당된 고유 시퀀스 번호
- TIME_WAIT ? 1. 지연 패킷이 발생할 경우 대비 ( 데이터 무결성 문제) 2. 두 장치가 연결 닫힘 확인
  ## 인터넷 계층
장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위한 계층, 상대방이 제대로 받았는지에 대해 보장하지 않는 비연결형적 특징.

- IP : 네트워크상의 기기에 주소를 할당하거나 해당 주소로 전송하는 역할
- ARP : 통신할 때 MAC 주소를 조사하는 프로토콜
- ICMP
  ## 링크 계층
  실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 **'규칙'**을 정하는 계층. 네트워크 접근 계층.
  - 물리계층 : 유무선 LAN을 통해 0/1 데이터 보내는 계층.
  - 데이터 링크 계층 : 이더넷 프레임을 통해 에러확인, 흐름제어, 접근 제어를 담당하는 계층.
  - 전이중화 통신 : 양쪽장치가 동시에 송수신할 수 있음, 현대의 고속 이더넷 방식 EX) CSMA/CD
  - 반이중화 통신 : 양쪽 장치가 서로 수신할 수 있지만, 동시에는 통신할 수 없으며, 한번에 한방향만 통신 가능. EX) CSMA/CA
   **이더넷 프레임**
  데이터 링크 계층은 이더넷 프레임을 통해 전달받은 데이터의 에러를 검출하고 캡슐화.

  ### 계층 간 데이터 송수신 과정
  HTTP를 통해 웹서버에 있는 데이터를 요청한다 ?
  요청값들이 캡슐화 과정을 거쳐 전달 -> 링크 계층을 통해 해당서버와 통신 -> 애플리케이션 계층까지 비캡슐화 과정
  - 캡슐화과정 : 상위계층의 헤더와 데이터를 하위계층의 데이터 부분에 포함시키고 해당 계층의 헤더를 삽입하는 과정
  애플리케이션 계층 데이터 -> 전송계층 -> '세그먼트', '데이터그램'화 -> 인터넷계층 -> '패킷'화-> 링크계층 ->'프레임화' 
  - 비캡슐화과정 : 하위계층 -> 상위계층 , 각 계층의 헤더 부분을 제거
  ### PDU
  네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리 단위
  - 헤더 : 제어관련 정보들이 포함
  - 페이로드 : 데이터 의미
  계층별로 부르는 용어가 다름.
  - 애플리케이션 : 메시지
  - 전송계층 : 세그먼트(TCP). 데이터그램(UDP)
  - 인터넷계층 : 패킷
  - 링크계층 : 프레임(데이터링크계층), 비트(물리계층)

    ### PDU TESTING
   **curl** www.naver.com

    <img width="400" height="350" alt="image" src="https://github.com/Woori-FISA-CS-Study/CS-Study/assets/35751392/669de142-3a8b-4696-aa49-43a7d059630f">


# 네트워크 기기 처리범위

# 애플리케이션 계층 처리 기기

## L7 스위치 (로드밸런서)

- 서버 부하 분산하는 기기
- 시스템이 처리하는 트래픽 증가를 목표
- URL, 서버, 캐시, 쿠키 기반으로 트래픽 분산
- 필터링 기능( 바이러스, 외부데이터)
- 헬스체크 : 장애 발생한 서버가 있다면 트래픽 분산에서 제외.
- 서버 이중화

L4 VS L7 ?

- L4 스위치는 전송 계층을 처리하는 기기 , IP/포트 기반 트래픽 분산
- L7 IP,포트 이외에도 URL, HTTP, 헤더, 쿠키 등을 기반으로 트래픽 분산
- AWS 환경에서 L7 로드밸런싱은 ALB , L4 로드밸런싱은 NLB 컴포넌트 이용.

# 인터넷 계층 처리 기기

## 라우터

- 여러개의 네트워크를 연결, 분할, 구분시켜주는 역할
- 다른 네트워크에 존재하는 장치끼리 서로 데이터를 주고 받을때
- 패킷 소모 최소화, 경로 최적화하여 최소 경로로 패킷을 포워딩

## L3 스위치

- L2 스위치의 기능과 라우팅 기능을 갖춘 장비

# 데이터 링크 계층 처리 기기

## L2 스위치

- 장치들의 MAC주소를 MAC 주소테이블을 통해 관리
- 패킷전송 담당

## 브리지

- 두개의 근거리 통신망을 상호 접속할 수 있도록 하는 통신망 연결 장치

# 물리 계층 처리 기기

## NIC

- 랜카드.
- 컴퓨터 내 설치하는 확장카드

## 리피터

- 약해진 신호 정도를 증폭하여 다른쪽으로 전달하는 장치

## AP

- 패킷을 복사하는 기기
- AP에 유선랜 연결 후 다른 장치에서 무선 랜을 사용하여 무선 네트워크 연결.

# IP주소

## ARP

- ARP를 통해 가상 주소인 IP주소를 실제 주소인 MAC주소로 반환. 반대의 경우도 가능.

## 홉바이홉 통신

- IP주소를 통해 통신하는 과정.
- 패킷이 여러개의 라우터를 건너가는 모습을 비유적으로 표현

## 라우팅 테이블

- 송신지에서 수신지까지 도달하기 위해 사용.
- 라우터에 들어가있는 목적지 정보들과 목적지로 가기 위한 방법이 있는 리스트

## 게이트웨이

- 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문역할.

## IP주소 체계

## IPv4 vs IPv6

ipv4 : 현재 가장 많이 쓰이는 주소 체계

## DHCP

- ip주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜

## NAT

- 패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP주소 정보를 수정하여 IP주소를 다른 주소로 매핑하는 방법.
- 여러대의 호스트가 하나의 공인 ip주소를 사용하여 인터넷에 접속하기 위해 사용
- 보안 : 내부 네트워크 ip주소와 외부에 드러나는 ip주소가 다르게 유지할 수 있어 어느정도의 보안이 가능
- 여러명이 동시에 인터넷에 접속하므로 호스트 숫자에 따라 속도가 느려질 수 있음.

## HTTP/1.0

- 기본적으로 한 연결당 하나의 요청을 처리하도록 설계. → RTT 증가 문제
- RTT문제 해결
- 이미지 스플리팅
- 코드압축
- 이미지 Base64 인코딩

## HTTP/1.1

- 매번 TCP연결하는 것이 아니라 한번 TCP 초기화 한 이후에 keep-alive 옵션으로 여러개의 파일을 송수신 할 수 있게 바뀜.
- HOL Blocking : 네트워크에서 같은 큐에 있는 패킷이 그 첫번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상
- 무거운 헤더 구조 : 메타데이터가 압축X

## HTTP/2

- SPDY 프로토콜 : 지연시간 줄이고 응답시간을 더 빠르게 함. 우선순위를 지원.
- 멀티플렉싱 : 여러 개의 스트림을 사용하여 송수신.
- 헤어 압축 : 허프만 코딩 압축 알고리즘을 사용하는 HPACK 압축형식.
- 허프만 코딩 : 문자열을 문자단위로 쪼개 빈도수를 세어 빈도가 높은 정보는 적은 비트 수를 사용하고, 빈도가 낮은 비트수를 많이 사용하여 전체 데이터에 표현하는 비트양을 줄이는 원리.
- 서버푸시 : 클라이언트 요청 없이 서버가 바로 리소스를 푸시 할 수 있음. ex) html을 읽으면서 css파일을 서버에서 푸시하여 클라이언트에게 먼저 줌.

## HTTPS

- 애플리케이션 계층과 전송 계층 사이에 신뢰계층인 SSL/TLS 계층을 넣은 신뢰할 수 있는 HTTP 요청을 말함. ‘통신을 암호화’ 한다라고 함.
- SSL/TLS : 전송계층에서 보안을 제공하는 프로토콜. 인증 메커니즘, 키교환 암호화 알고리즘, 해싱 알고리즘이 사용됨
- 보안세션 : 보안이 시작되고 끝나는 동안 유지되는 세션. 핸드셰이크를 통해 보안 세션을 생성하고 상태정보를 제공함.
- 사이퍼슈트
- AEAD 사이퍼모드
- 인증메커니즘 : CA에서 발급한 인증서를 기반으로 이루어짐.
- CA 발급과정 ; 자신의 사이트 정보와 공개키를 CA에 제출
- 암호화 알고리즘 : 키교환 알고리즘에는 ECDHE, DHE 가 있음. 둘 다 디피-헬만 방식.
- 디피-헬만 키 교환 암호화 알고리즘 : 암호키 교환 방식.
- 해싱 알고리즘 : 데이터를 추정하기 힘든 더 작고, 섞여 있는 조각으로 만듬. SHA_256 알고리즘.
- SEO(검색엔진 최적화)에 도움이 됨.

## HTTP/3

- QUIC 이라는 계층 위에서 돌아감.
- UDP 기반으로 돌아감.
- 초기 연결 설정 시 지연시간 감소 → TCP를 사용하지 않아 3-웨이 핸드셰이크 과정이 없으므로.
- 순방향 오류 수정 메커니즘 적용.
